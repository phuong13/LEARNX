import{c as A,P as Q,q as C,r as n,j as e,an as O,z as b,al as k,u as X,b as V,B as Y,L as M,W as R,ao as ee,v as se,am as T,A as D,D as te}from"./index-BpQV1TEo.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=A("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=A("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=A("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function q({timeRemaining:y}){const{assignmentId:p}=C(),[i,o]=n.useState([]);n.useEffect(()=>{(async()=>{await b.get(`/assignment-submissions/assignment/${p}`).then(d=>{o(d.data.data)}).catch(d=>{console.log(d)})})()},[p]),i.length;const j=i.filter(r=>r.fileSubmissionUrl||r.textSubmission).length,N=i.filter(r=>r.score===null||r.score===void 0).length;return e.jsxs("div",{className:"mx-auto p-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-700",children:"Th·ªëng k√™ ƒëi·ªÉm s·ªë"}),e.jsx("div",{className:"rounded-lg overflow-hidden",children:e.jsxs("div",{className:"divide-y divide-slate-200",children:[e.jsxs("div",{className:"flex items-center p-2 ",children:[e.jsx(ne,{className:"w-5 h-5 text-green-500 mr-4"}),e.jsx("span",{className:"text-slate-700",children:"ƒê√£ n·ªôp b√†i"}),e.jsx("span",{className:"ml-auto font-semibold text-slate-700",children:j})]}),e.jsxs("div",{className:"flex items-center p-2 hover:bg-slate-50 transition-colors",children:[e.jsx(ae,{className:"w-5 h-5 text-yellow-500 mr-4"}),e.jsx("span",{className:"text-slate-700",children:"C·∫ßn ch·∫•m ƒëi·ªÉm"}),e.jsx("span",{className:"ml-auto font-semibold text-slate-700",children:N})]}),e.jsxs("div",{className:"flex items-center p-2 hover:bg-slate-50 transition-colors",children:[e.jsx(O,{className:"w-5 h-5 text-red-500 mr-4"}),e.jsx("span",{className:"text-slate-700",children:"Th·ªùi gian c√≤n l·∫°i"}),e.jsx("span",{className:"ml-auto font-semibold text-slate-700",children:y})]})]})})]})}q.propTypes={timeRemaining:Q.string.isRequired};function ie({title:y,content:p,startDate:i,endDate:o}){const[j,N]=n.useState(!1),[r,d]=n.useState(!0),[h,c]=n.useState(null),[v,B]=n.useState(null),P=i&&!isNaN(new Date(i))?k(new Date(i),"EEEE, dd 'th√°ng' MM yyyy, hh:mm a",{locale:T}):"Invalid date",G=o&&!isNaN(new Date(o))?k(new Date(o),"EEEE, dd 'th√°ng' MM yyyy, hh:mm a",{locale:T}):"Invalid date",{authUser:I}=X(),_=()=>{N(!j)},[F,u]=n.useState(!0);console.log("üöÄ ~ SubmissionLayout ~ isLoading:",F);const[t,w]=n.useState(null),{assignmentId:S}=C(),{courseId:$}=C(),L=a=>{const s=new Date(o),l=new Date(a),g=l-s,x=Math.abs(g),m=Math.floor(x/(1e3*60*60*24)),f=Math.floor(x/(1e3*60*60)%24),z=Math.floor(x/(1e3*60)%60),H=Math.floor(x/1e3%60);return l<s?e.jsxs("td",{className:"py-3 text-blue-500",children:["N·ªôp s·ªõm ",m>0?`${m} ng√†y `:"",f," gi·ªù ",z," ph√∫t ",H," gi√¢y"]}):e.jsxs("td",{className:"py-3 text-rose-600",children:["N·ªôp tr·ªÖ ",m>0?`${m} ng√†y `:"",f," gi·ªù ",z," ph√∫t ",H," gi√¢y"]})},E=a=>{if(Array.isArray(a)&&a.length>=6){const[s,l,g,x,m,f]=a;return new Date(s,l-1,g,x,m,f)}return null};n.useEffect(()=>{(async()=>{u(!0);const s=await b.get(`courses/${$}`);s.status===200&&(B(s.data.data),u(!1))})()},[$]),n.useEffect(()=>{(async()=>{u(!0);try{const s=await b.get(`/assignment-submissions/${S}/logged-in`);s.data.data.fileSubmissionUrl!=null?w(s.data.data):w(null)}catch{w(null)}finally{u(!1)}})()},[S]);const U=a=>{const s=new Date,l=new Date(a);if(isNaN(l.getTime()))return"Ng√†y h·∫øt h·∫°n kh√¥ng h·ª£p l·ªá";const g=l.getTime()-s.getTime();if(g<=0)return"ƒê√£ h·∫øt h·∫°n";const x=Math.floor(g/(1e3*60*60*24)),m=Math.floor(g%(1e3*60*60*24)/(1e3*60*60)),f=Math.floor(g%(1e3*60*60)/(1e3*60));return x>0?`C√≤n l·∫°i ${x} ng√†y ${m} gi·ªù`:m>0?`C√≤n l·∫°i ${m} gi·ªù ${f} ph√∫t`:`C√≤n l·∫°i ${f} ph√∫t`},J=()=>{d(!r)},K=a=>{c(a.target.files[0])},W=()=>{c(null),N(!j)},Z=async()=>{const a=new FormData;a.append("document",h);try{if(t){u(!0);const s=await b.patch(`/assignment-submissions/${S}`,a,{headers:{"Content-Type":"multipart/form-data"}});u(!1),console.log(s),s.status===200?(D.success(s.data.message),w(s.data.data)):D.error(s.data.message,{type:"error"})}else{const s={assignmentId:S,textSubmission:""};a.append("assignment",new Blob([JSON.stringify(s)],{type:"application/json"})),u(!0);const l=await b.post("/assignment-submissions",a,{headers:{"Content-Type":"multipart/form-data"}});console.log(l),u(!1),l.status===201||l.status===200?(D.success(l.data.message),w(l.data.data)):D.error(l.data.message,{type:"error"})}}catch(s){D.error(s.response.data.message,{type:"error"})}};return e.jsx("div",{className:"",children:F?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(V,{isLoading:!0})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative h-48 bg-emerald-200 overflow-hidden",children:[e.jsx("img",{src:Y,alt:"Online learning illustration",className:"w-full h-fit object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsx("div",{className:"absolute top-4 left-4 right-4 flex justify-between items-start",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"bg-primaryDark text-white px-4 py-2 rounded-lg text-sm font-semibold shadow-md",children:e.jsx("nav",{"aria-label":"breadcrumb",children:e.jsxs("ol",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"fa-solid fa-file-arrow-up text-white text-xl mr-2"}),e.jsx("li",{children:e.jsx(M,{to:"/",className:"text-white hover:underline",children:"Trang ch·ªß"})}),e.jsx("li",{children:e.jsx("span",{className:"mx-2 text-gray-300",children:"/"})}),e.jsx("li",{children:e.jsx(M,{to:"/my-course",className:"text-white hover:underline",children:"Kh√≥a h·ªçc"})}),e.jsx("li",{children:e.jsx("span",{className:"mx-2 text-gray-300",children:"/"})}),e.jsx(M,{to:`/course-detail/${v==null?void 0:v.id}`,className:"text-white hover:underline",children:(v==null?void 0:v.name)||"ƒêang t·∫£i..."}),e.jsx("li",{children:e.jsx("span",{className:"mx-2 text-gray-300",children:"/"})}),e.jsx("li",{className:"text-gray-200",children:y||"ƒêang t·∫£i..."})]})})})})})]}),e.jsx("div",{className:"pt-4 relative",children:e.jsxs("div",{className:"bg-white shadow-lg overflow-hidden rounded-lg",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2 text-slate-700",children:"Th·ªùi gian"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between text-sm text-gray-600",children:[e.jsxs("p",{className:"mb-2 sm:mb-0",children:[e.jsx(R,{className:"inline mr-2",size:16})," Opened: ",P]}),e.jsxs("p",{children:[e.jsx(R,{className:"inline mr-2",size:16})," Due: ",G]})]})]}),e.jsxs("div",{className:"p-4 border-b border-slate-700",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2 text-slate-700",children:"H∆∞·ªõng d·∫´n n·ªôp b√†i"}),e.jsx("div",{className:"pb-2",dangerouslySetInnerHTML:{__html:p}}),I.role==="TEACHER"?e.jsx("button",{className:"py-2 px-4  bg-primaryDark text-white rounded-lg  hover:bg-secondary transition-colors",children:e.jsx(M,{to:`/grading/${$}/${S}`,className:"text-white",children:"Ch·∫•m ƒëi·ªÉm"})}):e.jsx("button",{onClick:_,className:"py-2 px-4 bg-primaryDark text-white rounded-lg  hover:bg-secondary transition-colors",children:t?"S·ª≠a b√†i n·ªôp":"Th√™m b√†i n·ªôp"}),j&&e.jsxs("div",{className:"mt-2 p-4 bg-slate-100 rounded-lg shadow-md",children:[e.jsx("div",{className:"text-lg font-semibold mb-2 text-slate-800",children:"T·∫£i t·ªáp b√†i n·ªôp c·ªßa b·∫°n"}),h&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-700 mr-4",children:"File ƒë√£ ch·ªçn: "}),e.jsx("span",{className:"text-blue-700 mr-4",children:h.name})]}),!h&&e.jsx("input",{type:"file",accept:".pdf,.doc,.docx,.xlsx,.xls",className:"block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer",onChange:K}),t&&!h&&t.fileSubmissionUrl&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-700 mr-4",children:"File ƒë√£ n·ªôp: "}),e.jsx("span",{className:"text-blue-700 mr-4",children:decodeURIComponent(t.fileSubmissionUrl.split("/").pop())})]}),e.jsxs("div",{className:"flex justify-center mt-4",children:[e.jsx("button",{onClick:()=>Z(),disabled:!h,className:`mr-4 text-white text-m px-3 py-1 rounded-lg transition-colors shadow-md ${h?"bg-blue-400 hover:bg-blue-600":"bg-slate-300 cursor-not-allowed"}`,children:"N·ªôp b√†i"}),e.jsx("button",{className:"mr-4 bg-rose-400 text-white text-m px-3 py-1 rounded-lg hover:bg-rose-700 transition-colors shadow-md",onClick:()=>W(),children:"Hu·ª∑ ch·ªçn"})]})]})]}),I.role==="STUDENT"&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2 cursor-pointer",onClick:J,children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700",children:"Tr·∫°ng th√°i b√†i n·ªôp"}),r?e.jsx(ee,{size:20}):e.jsx(se,{size:20})]}),r&&e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-slate-300",children:[e.jsx("td",{className:"py-3 font-medium text-gray-700",children:"Th·ªùi gian n·ªôp"}),t?e.jsx(e.Fragment,{children:t.updatedAt?L(E(t.updatedAt)):L(E(t.createdAt))}):e.jsx("td",{className:"py-3 text-rose-600",children:"Ch∆∞a n·ªôp b√†i"})]}),e.jsxs("tr",{className:"border-b border-slate-300",children:[e.jsx("td",{className:"py-3 font-medium text-gray-700",children:"File ƒë√£ n·ªôp"}),t&&t.fileSubmissionUrl?e.jsx("td",{className:" text-gray-600",children:e.jsxs("div",{className:"flex",children:[e.jsx(le,{className:"mr-2 text-blue-600",size:18}),e.jsx("a",{className:"text-blue-500 hover:underline",href:`http://docs.google.com/gview?url=${t.fileSubmissionUrl}&embedded=true`,children:decodeURIComponent(t.fileSubmissionUrl.split("/").pop())})]})}):e.jsx("td",{className:"py-3 text-gray-600"})]}),e.jsxs("tr",{className:"border-b border-slate-300",children:[e.jsx("td",{className:"py-3 font-medium text-gray-700",children:"ƒêi·ªÉm"}),e.jsx("td",{className:"py-3 text-gray-600",children:t?t.score?t.score:"Ch∆∞a ch·∫•m ƒëi·ªÉm":"..."})]}),e.jsxs("tr",{className:"border-b border-slate-300",children:[e.jsx("td",{className:"py-3 font-medium text-gray-700",children:"Th·ªùi gian c√≤n l·∫°i"}),e.jsxs("td",{className:"py-3 text-gray-600 flex items-center",children:[e.jsx(O,{className:"mr-2",size:16}),U(o)]})]}),e.jsxs("tr",{className:"border-b border-slate-300",children:[e.jsx("td",{className:"py-3 font-medium text-gray-700",children:"Ch·ªânh s·ª≠a l·∫ßn cu·ªëi"}),e.jsx("td",{className:"py-3 text-gray-600",children:t&&t.updatedAt?k(E(t.updatedAt),"EEEE, dd 'th√°ng' MM yyyy, hh:mm a",{locale:T}):t&&k(E(t.createdAt),"EEEE, dd 'th√°ng' MM yyyy, hh:mm a",{locale:T})})]})]})})]}),e.jsx("div",{className:"",children:I.role==="TEACHER"&&e.jsx(q,{timeRemaining:U(o)})})]})})]})})}const ce=()=>{const{courseId:y}=C(),{assignmentId:p}=C(),[i,o]=n.useState(null),[j,N]=n.useState(null),[r,d]=n.useState(!1);return n.useEffect(()=>{(async()=>{d(!0);try{const c=await b.get(`courses/${y}`);c.status===200&&N(c.data.data)}catch(c){console.log(c)}finally{d(!1)}})()},[y]),n.useEffect(()=>{(async()=>{d(!0);try{const c=await b.get(`/assignments/${p}`,{headers:{"Content-Type":"application/json"}});o(c.data.data)}catch(c){console.log(c)}finally{d(!1)}})()},[p]),e.jsxs(e.Fragment,{children:[e.jsx(te,{title:"N·ªôp b√†i"}),e.jsx("div",{className:"flex flex-col min-h-[calc(100vh-193px)]",children:e.jsx("div",{className:"flex-1 pr-6 pl-6",children:r?e.jsx(V,{isLoading:r,className:"flex justify-center items-center h-full"}):i&&e.jsx(ie,{title:i.title,content:i.content,startDate:i.startDate,endDate:i.endDate})})})]})};export{ce as default};
