import{c as S,j as e,ab as v,r as l,i as T,k,bq as _,s as L,a as b,aM as D,b as F,q as I,t as P,C as $,D as E}from"./index-BpQV1TEo.js";import{I as M}from"./InputAdornment-BRxDvZJ8.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=S("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),q=({nameCourse:a,onClick:r,isActive:s})=>e.jsx("div",{onClick:r,className:`flex items-center gap-2 px-3 py-2 text-slate-600 hover:rounded-lg  w-full transition mb-2 cursor-pointer border-b border-slate-400 ${s?"bg-slate-200 rounded-lg":"bg-gray-100 hover:bg-slate-200"}`,children:e.jsx("span",{className:"text-base font-semibold",children:a})}),z=()=>{const a=v(),[r,s]=l.useState(!1);return{createForum:async n=>{s(!0);try{const m=await a.post("/forums",{courseId:n,title:"New Forum",description:"Description of the new forum"})}catch{}finally{s(!1)}},loading:r}};var N={},A=k;Object.defineProperty(N,"__esModule",{value:!0});var y=N.default=void 0,B=A(T()),O=e;y=N.default=(0,B.default)((0,O.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");const U=()=>{const{courses:a,loading:r}=_(),{createForum:s,loading:u}=z(),n=L(),{t:m}=b(),[h,i]=l.useState(null),[t,o]=l.useState(""),f=c=>{i(c),s(c),n(`/forum/${c}`)},p=l.useMemo(()=>t.trim()?a.filter(c=>c.name.toLowerCase().includes(t.toLowerCase())):a,[a,t]);return e.jsxs("div",{className:"h-full flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2 p-2",children:[e.jsx("p",{className:"text-slate-600 font-semibold text-lg ",children:m("Forum")}),e.jsx(D,{fullWidth:!0,placeholder:m("forum.search_course_placeholder"),value:t,onChange:c=>o(c.target.value),variant:"outlined",size:"small",InputProps:{startAdornment:e.jsx(M,{position:"start",children:e.jsx(y,{color:"action"})})}})]}),r?e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(F,{isLoading:!0})}):e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:p.length>0?p.map(c=>e.jsx(q,{nameCourse:c.name,onClick:()=>f(c.id),isActive:h===c.id},c.id)):e.jsx("p",{className:"text-center text-slate-700 py-4",children:m("forum.no_courses_found")})})]})},X=()=>{const a=v();l.useState(null);const[r,s]=l.useState(!1),[u,n]=l.useState(null);return{createTopicComment:async({content:i,topicId:t})=>{s(!0),n(null);try{const o=await a.post("/topiccomments",{content:i,topicId:t})}catch(o){console.error("Lỗi khi tạo topic:",o),n(o)}finally{s(!1)}},getTopicComment:async i=>{s(!0),n(null);try{return(await a.get(`/topics/comments/${i}`)).data}catch(t){return console.error("Lỗi khi lấy danh sách topic:",t),n(t),null}finally{s(!1)}}}},j="/LEARNX/assets/profile-user-DfsRXmBN.png",H=({user:a,content:r,createAt:s,topicId:u})=>{const n=JSON.parse(localStorage.getItem("user")||"{}"),{createTopicComment:m,getTopicComment:h}=X(),{t:i}=b(),[t,o]=l.useState(""),[f,p]=l.useState([]),[c,g]=l.useState(!1),d=async()=>{const x=await h(u);p(x.data||[])};l.useEffect(()=>{d()},[]);const C=async()=>{t.trim()&&(await m({content:t,topicId:u}),o(""),d())};return e.jsxs("div",{className:"w-full p-4 bg-white rounded-lg shadow-lg border border-slate-200",children:[e.jsxs("div",{className:" flex items-center gap-2",children:[e.jsx("div",{className:"flex-shrink-0 w-[30px] h-[30px] rounded-full overflow-hidden border border-slate-300",children:e.jsx("img",{src:a.avatarUrl||j,alt:"",className:"w-full h-full object-cover"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold text-sm text-slate-700 truncate",children:a.username}),e.jsx("span",{className:"text-sm text-slate-500",children:w(s)})]})})]}),e.jsx("div",{className:"flex my-2 mx-4",children:e.jsxs("p",{className:"text-slate-700 text-sm ",children:[e.jsx("span",{className:"text-slate-700 text-base font-semibold"})," ",r]})}),e.jsxs("div",{className:"px-4 border-t border-slate-300 mx-2",children:[e.jsx("div",{className:"flex items-center gap-2 text-slate-600 cursor-pointer mt-2",onClick:()=>g(!c),children:e.jsx("span",{className:"text-sm text-slate-500 hover:underline hover:text-slate-600 transition",children:i("topic.comments_count",{count:f.length})})}),c&&e.jsx("div",{className:"px-4 my-2 space-y-2",children:f.length===0?e.jsx("p",{className:"text-slate-400 text-sm",children:i("topic.no_comments")}):f.map(x=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"flex-shrink-0 w-[30px] h-[30px] rounded-full overflow-hidden border border-slate-300",children:e.jsx("img",{src:j,alt:"",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 bg-slate-50 p-2 rounded-md",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"font-semibold text-sm text-slate-700",children:x.account.email}),e.jsx("div",{className:"text-sm text-slate-500",children:w(x.createdAt)})]}),e.jsx("p",{className:"text-slate-700 text-sm",children:x.content})]})]},x.id))})]}),e.jsxs("div",{className:"px-4 flex items-center gap-3 mt-2",children:[e.jsx("div",{className:"flex-shrink-0 w-[30px] h-[30px] rounded-full overflow-hidden border border-slate-300",children:e.jsx("img",{src:n.avatar||j,alt:"",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:t,onChange:x=>o(x.target.value),placeholder:i("topic.comment_input_placeholder"),className:"w-full py-2 px-3 border-b border-slate-300 focus:outline-none text-slate-600 "}),e.jsx("button",{className:"absolute right-2 top-1/2 -translate-y-1/2 contrast-50 hover:contrast-200 transition",onClick:C,children:e.jsx(R,{className:"w-5 h-5"})})]})]})]})},w=a=>{const r=new Date(a[0],a[1]-1,a[2],a[3],a[4],a[5],Math.floor(a[6]/1e6)),s=u=>String(u).padStart(2,"0");return`${s(r.getHours())}:${s(r.getMinutes())}
     ${s(r.getDate())}/${s(r.getMonth()+1)}/${r.getFullYear()}`},J=()=>{const a=v();l.useState(null);const[r,s]=l.useState(!1),[u,n]=l.useState(null);return{createTopic:async({content:i,forumId:t})=>{s(!0),n(null);try{const o=await a.post("/topics",{content:i,forumId:t})}catch(o){console.error("Lỗi khi tạo topic:",o),n(o)}finally{s(!1)}},getTopics:async i=>{s(!0),n(null);try{return(await a.get(`/forums/forum/${i}/topics`)).data}catch(t){return console.error("Lỗi khi lấy danh sách topic:",t),n(t),null}finally{s(!1)}}}},W=()=>{const[a,r]=l.useState(!1),[s,u]=l.useState(""),[n,m]=l.useState([]),[h,i]=l.useState(!1),{forumId:t}=I(),{t:o}=b(),{createTopic:f,getTopics:p}=J(),c=async()=>{if(t){i(!0);try{const d=await p(t);m(d.data||[])}catch(d){console.error("Lỗi khi lấy danh sách topics:",d)}finally{i(!1)}}};l.useEffect(()=>{c()},[t]);const g=async()=>{if(!(!s.trim()||!t))try{await f({content:s,forumId:t}),await c(),r(!1),u("")}catch(d){console.error("Lỗi khi tạo topic:",d)}};return e.jsxs("div",{className:"flex flex-col gap-4 p-4 h-full focus:outline-none",tabIndex:-1,children:[t?e.jsx("button",{className:"py-2 px-4 bg-primaryDark text-white rounded-lg hover:bg-secondary transition-colors",onClick:()=>r(!0),children:o("forum.create_topic")}):e.jsx("div",{className:"text-lg text-center text-slate-600 font-semibold pt-6 h-full bg-white rounded-lg shadow-md",children:o("forum.please_select_forum")}),h?e.jsx(P,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:e.jsx($,{})}):n.length>0&&t?e.jsx("div",{className:"flex flex-col gap-4 h-full bg-white rounded-lg shadow-md p-6 overflow-y-auto",children:n.map(d=>e.jsx(H,{topicId:d.id,user:d.account,content:d.content,createAt:d.createdAt},d.id))}):t&&e.jsx("div",{className:"text-center mt-6 text-slate-600 font-semibold",children:o("forum.no_topics")}),a&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-30",children:e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg w-[90%] max-w-xl h-[405px]",children:[e.jsx("h2",{className:"text-lg text-slate-600 font-semibold mb-2",children:o("forum.new_topic_title")}),e.jsx("textarea",{className:"w-full h-[300px] border border-slate-300 focus:border-slate-400 outline-none p-2 rounded-md text-slate-600",placeholder:o("forum.new_topic_placeholder"),value:s,onChange:d=>u(d.target.value),autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"py-2 px-6 bg-primaryDark text-white rounded-lg hover:bg-secondary transition-colors",onClick:()=>r(!1),children:o("forum.cancel")}),e.jsx("button",{className:"py-2 px-6 bg-primaryDark text-white rounded-lg hover:bg-secondary transition-colors",onClick:g,children:o("forum.submit")})]})]})})]})},Y=()=>e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{className:" w-1/4 h-full bg-white p-4 m-4 rounded-lg",children:e.jsx(U,{})}),e.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar",children:e.jsx(W,{})})]}),Q=()=>e.jsxs("div",{className:"flex flex-col min-h-[calc(100vh-193px)] ",children:[e.jsx(E,{title:"Forum"}),e.jsx("div",{className:"flex-grow h-0 overflow-hidden bg-slate-200",children:e.jsx(Y,{})})]});export{Q as default};
