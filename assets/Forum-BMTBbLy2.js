import{c as S,j as e,a9 as j,h as T,i as k,br as _,q as L,a as b,r as n,aL as F,o as D}from"./index-VBMHM8Ib.js";import{I}from"./InputAdornment-Cq1minZk.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=S("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),$=({nameCourse:t,onClick:r,isActive:s})=>e.jsx("div",{onClick:r,className:`flex items-center gap-2 px-3 py-2 text-slate-600 hover:rounded-lg  w-full transition mb-2 cursor-pointer border-b border-slate-400 ${s?"bg-slate-200 rounded-lg":"bg-gray-100 hover:bg-slate-200"}`,children:e.jsx("span",{className:"text-base font-semibold",children:t})}),E=()=>{const t=j();return{createForum:async s=>{try{const m=await t.post("/forums",{courseId:s,title:"New Forum",description:"Description of the new forum"})}catch{}}}};var N={},M=k;Object.defineProperty(N,"__esModule",{value:!0});var y=N.default=void 0,R=M(T()),q=e;y=N.default=(0,R.default)((0,q.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");const z=()=>{const{courses:t}=_(),{createForum:r}=E(),s=L(),{t:m}=b(),[c,h]=n.useState(null),[u,i]=n.useState(""),a=l=>{h(l),r(l),s(`/forum/${l}`)},o=n.useMemo(()=>u.trim()?t.filter(l=>l.name.toLowerCase().includes(u.toLowerCase())):t,[t,u]);return e.jsxs("div",{className:"h-full flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2 p-2",children:[e.jsx("p",{className:"text-slate-600 font-semibold text-lg ",children:m("Forum")}),e.jsx(F,{fullWidth:!0,placeholder:m("forum.search_course_placeholder"),value:u,onChange:l=>i(l.target.value),variant:"outlined",size:"small",InputProps:{startAdornment:e.jsx(I,{position:"start",children:e.jsx(y,{color:"action"})})}})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:o.length>0?o.map(l=>e.jsx($,{nameCourse:l.name,onClick:()=>a(l.id),isActive:c===l.id},l.id)):e.jsx("p",{className:"text-center text-slate-700 py-4",children:m("forum.no_courses_found")})})]})},A=()=>{const t=j();n.useState(null);const[r,s]=n.useState(!1),[m,c]=n.useState(null);return{createTopicComment:async({content:i,topicId:a})=>{s(!0),c(null);try{const o=await t.post("/topiccomments",{content:i,topicId:a})}catch(o){console.error("Lỗi khi tạo topic:",o),c(o)}finally{s(!1)}},getTopicComment:async i=>{s(!0),c(null);try{return(await t.get(`/topics/comments/${i}`)).data}catch(a){return console.error("Lỗi khi lấy danh sách topic:",a),c(a),null}finally{s(!1)}}}},v="/LEARNX/assets/profile-user-DfsRXmBN.png",O=({user:t,content:r,createAt:s,topicId:m})=>{const c=JSON.parse(localStorage.getItem("user")||"{}"),{createTopicComment:h,getTopicComment:u}=A(),{t:i}=b(),[a,o]=n.useState(""),[l,f]=n.useState([]),[p,g]=n.useState(!1),d=async()=>{const x=await u(m);f(x.data||[])};n.useEffect(()=>{d()},[]);const C=async()=>{a.trim()&&(await h({content:a,topicId:m}),o(""),d())};return e.jsxs("div",{className:"w-full p-4 bg-white rounded-lg shadow-lg border border-slate-200",children:[e.jsxs("div",{className:" flex items-center gap-2",children:[e.jsx("div",{className:"flex-shrink-0 w-[30px] h-[30px] rounded-full overflow-hidden border border-slate-300",children:e.jsx("img",{src:t.avatarUrl||v,alt:"",className:"w-full h-full object-cover"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold text-sm text-slate-700 truncate",children:t.username}),e.jsx("span",{className:"text-sm text-slate-500",children:w(s)})]})})]}),e.jsx("div",{className:"flex my-2 mx-4",children:e.jsxs("p",{className:"text-slate-700 text-sm ",children:[e.jsx("span",{className:"text-slate-700 text-base font-semibold"})," ",r]})}),e.jsxs("div",{className:"px-4 border-t border-slate-300 mx-2",children:[e.jsx("div",{className:"flex items-center gap-2 text-slate-600 cursor-pointer mt-2",onClick:()=>g(!p),children:e.jsx("span",{className:"text-sm text-slate-500 hover:underline hover:text-slate-600 transition",children:i("topic.comments_count",{count:l.length})})}),p&&e.jsx("div",{className:"px-4 my-2 space-y-2",children:l.length===0?e.jsx("p",{className:"text-slate-400 text-sm",children:i("topic.no_comments")}):l.map(x=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"flex-shrink-0 w-[30px] h-[30px] rounded-full overflow-hidden border border-slate-300",children:e.jsx("img",{src:v,alt:"",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 bg-slate-50 p-2 rounded-md",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"font-semibold text-sm text-slate-700",children:x.account.email}),e.jsx("div",{className:"text-sm text-slate-500",children:w(x.createdAt)})]}),e.jsx("p",{className:"text-slate-700 text-sm",children:x.content})]})]},x.id))})]}),e.jsxs("div",{className:"px-4 flex items-center gap-3 mt-2",children:[e.jsx("div",{className:"flex-shrink-0 w-[30px] h-[30px] rounded-full overflow-hidden border border-slate-300",children:e.jsx("img",{src:c.avatar||v,alt:"",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:a,onChange:x=>o(x.target.value),placeholder:i("topic.comment_input_placeholder"),className:"w-full py-2 px-3 border-b border-slate-300 focus:outline-none text-slate-600 "}),e.jsx("button",{className:"absolute right-2 top-1/2 -translate-y-1/2 contrast-50 hover:contrast-200 transition",onClick:C,children:e.jsx(P,{className:"w-5 h-5"})})]})]})]})},w=t=>{const r=new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5],Math.floor(t[6]/1e6)),s=m=>String(m).padStart(2,"0");return`${s(r.getHours())}:${s(r.getMinutes())}
     ${s(r.getDate())}/${s(r.getMonth()+1)}/${r.getFullYear()}`},U=()=>{const t=j();n.useState(null);const[r,s]=n.useState(!1),[m,c]=n.useState(null);return{createTopic:async({content:i,forumId:a})=>{s(!0),c(null);try{const o=await t.post("/topics",{content:i,forumId:a})}catch(o){console.error("Lỗi khi tạo topic:",o),c(o)}finally{s(!1)}},getTopics:async i=>{s(!0),c(null);try{return(await t.get(`/forums/forum/${i}/topics`)).data}catch(a){return console.error("Lỗi khi lấy danh sách topic:",a),c(a),null}finally{s(!1)}}}},X=()=>{const[t,r]=n.useState(!1),[s,m]=n.useState(""),[c,h]=n.useState([]),[u,i]=n.useState(!1),{forumId:a}=D(),{t:o}=b(),{createTopic:l,getTopics:f}=U(),p=async()=>{if(a){i(!0);try{const d=await f(a);h(d.data||[])}catch(d){console.error("Lỗi khi lấy danh sách topics:",d)}finally{i(!1)}}};n.useEffect(()=>{p()},[a]);const g=async()=>{if(!(!s.trim()||!a))try{await l({content:s,forumId:a}),await p(),r(!1),m("")}catch(d){console.error("Lỗi khi tạo topic:",d)}};return e.jsxs("div",{className:"flex flex-col gap-4 p-4 h-full focus:outline-none",tabIndex:-1,children:[a?e.jsx("button",{className:"py-2 px-4 bg-primaryDark text-white rounded-lg hover:bg-secondary transition-colors",onClick:()=>r(!0),children:o("forum.create_topic")}):e.jsx("div",{className:"text-lg text-center text-slate-600 font-semibold pt-6 h-full bg-white rounded-lg shadow-md",children:o("forum.please_select_forum")}),u?e.jsxs("div",{className:"text-center text-slate-500 mt-4",children:[o("loading"),"..."]}):c.length>0&&a?e.jsx("div",{className:"flex flex-col gap-4 h-full bg-white rounded-lg shadow-md p-6 overflow-y-auto",children:c.map(d=>e.jsx(O,{topicId:d.id,user:d.account,content:d.content,createAt:d.createdAt},d.id))}):a&&e.jsx("div",{className:"text-center mt-6 text-slate-600 font-semibold",children:o("forum.no_topics")}),t&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-30",children:e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg w-[90%] max-w-xl h-[405px]",children:[e.jsx("h2",{className:"text-lg text-slate-600 font-semibold mb-2",children:o("forum.new_topic_title")}),e.jsx("textarea",{className:"w-full h-[300px] border border-slate-300 focus:border-slate-400 outline-none p-2 rounded-md text-slate-600",placeholder:o("forum.new_topic_placeholder"),value:s,onChange:d=>m(d.target.value),autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"py-2 px-6 bg-primaryDark text-white rounded-lg hover:bg-secondary transition-colors",onClick:()=>r(!1),children:o("forum.cancel")}),e.jsx("button",{className:"py-2 px-6 bg-primaryDark text-white rounded-lg hover:bg-secondary transition-colors",onClick:g,children:o("forum.submit")})]})]})})]})},B=()=>e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{className:" w-1/4 h-full bg-white p-4 m-4 rounded-lg",children:e.jsx(z,{})}),e.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar",children:e.jsx(X,{})})]}),W=()=>e.jsx("div",{className:"flex flex-col min-h-[calc(100vh-193px)] ",children:e.jsx("div",{className:"flex-grow h-0 overflow-hidden bg-slate-200",children:e.jsx(B,{})})});export{W as default};
